slave_raid = {
	name = CB_NAME_SLAVE_RAID
	war_name = WAR_NAME_SLAVE_RAID
	sprite = 7
	truce_days = 3650
	hostile_against_others = yes
	can_ask_to_join_war = no
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	
	allow_distant = yes # AI parameter
	
	can_use_gui = {		
		ROOT = {
			custom_tooltip = { text = TOOLTIPslave_raidBORDER }
			custom_tooltip = { text = TOOLTIPslave_raidCULTURE }
			custom_tooltip = { text = TOOLTIPslave_raidSACKED }
			custom_tooltip = { # Cannot use this within the same realm if crown authority is high
				text = TOOLTIPslave_raidCENTRALIZATION
				hidden_tooltip = {
					OR = {
						NOT = { same_realm = FROM }
						crownlaw_title = {
							OR = {
								has_law = centralization_0
								has_law = centralization_1
								has_law = pagan_centralization_0
								has_law = pagan_centralization_1
								has_law = pagan_centralization_2
							}
						}
					}
				}
			}			
		}
	}
	
	can_use = {
		ROOT = {
			NOT = {
				AND = {
					lower_tier_than = KING
					independent = yes
				}
			}
			NOT = {
				crownlaw_title = {
					OR = {
						has_law = slavery_0
						has_law = slavery_1
					}
				}
			}
			NOT = { trait = liberator }
			
		}	
	}
	
	can_use_title = {
		tier = COUNT
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
			}
		}
		
		location = {
			# One of the following must be true:
			#	The province borders the attacker's realm/demesne
			#	The province is coastal and the attacker is a patrician
			OR = {
				any_neighbor_province = {
					has_owner = yes
					owner = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
				AND = {
					port = yes
					ROOT = {
						OR = {
							is_merchant_republic = yes
							is_patrician = yes
						}
					}
				}
			}
			# Cannot use against same-culture-group provinces
			NOT = { culture_group = ROOT }
			# Must not already be sacked
			NOT = { has_province_modifier = sacked }
		}
	}
	
	is_valid = {
		ROOT = {
			NOT = {
				crownlaw_title = {
					OR = {
						has_law = slavery_0
						has_law = slavery_1
					}
				}
			}
			NOT = { trait = liberator }
		}
		
		# Cannot use this within the same realm if crown authority is high
		ROOT = {
			OR = {
				NOT = { same_realm = FROM }
				crownlaw_title = {
					OR = {
						has_law = centralization_0
						has_law = centralization_1
						has_law = pagan_centralization_0
						has_law = pagan_centralization_1
						has_law = pagan_centralization_2
					}
				}
			}
		}
		
	}
	
	is_valid_title = {
		tier = COUNT
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
			}
		}
		
		location = {
			# Must not already be sacked
			NOT = { has_province_modifier = sacked }
		}
	}
	
	on_add = {
		hidden_tooltip = {
			ROOT = {
				#character_event = { id = lirepublic.100 days = 1 } #Co-consuls can veto
			}
		}
	}
	
	on_success = {
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}
	
	on_success_title = {
		# Sack the province
		location = {
			add_province_modifier = {
				name = sacked
				duration = 1825
			}
			# The attacker gains a slave camp level
			if = {
				limit = { ROOT = { crownlaw_title = { has_law = slavery_2 } } }
				ROOT = { character_event = { id = slavery.1000 tooltip = "EVTTOOLTIPSLAVERY1000" } }
			}
			custom_tooltip = { # Give the attacker new slaves
				text = TOOLTIPslave_raid_new_slaves
				hidden_tooltip = {
					ROOT = {
						random_list = {
							50 = {
								create_random_diplomat = {
									random_traits = yes
									culture = PREVPREV
									religion = PREVPREV
									dynasty = none
								}
								hidden_tooltip = {
									new_character = {
										add_trait = slave
										give_minor_title = title_slave
										opinion = { who = ROOT modifier = opinion_my_owner }
										reverse_opinion = { who = ROOT modifier = opinion_my_slave }
										opinion = { who = ROOT modifier = opinion_enslaved_me }
									}
								}
							}
							50 = {
								create_random_diplomat = {
									female = yes
									random_traits = yes
									culture = PREVPREV
									religion = PREVPREV
									dynasty = none
								}
								hidden_tooltip = {
									new_character = {
										add_trait = slave
										give_minor_title = title_slave
										opinion = { who = ROOT modifier = opinion_my_owner }
										reverse_opinion = { who = ROOT modifier = opinion_my_slave }
										opinion = { who = ROOT modifier = opinion_enslaved_me }
									}
								}
							}
						}
						random_list = {
							50 = {
								create_random_soldier = {
									random_traits = yes
									culture = PREVPREV
									religion = PREVPREV
									dynasty = none
								}
								hidden_tooltip = {
									new_character = {
										add_trait = slave
										give_minor_title = title_slave
										opinion = { who = ROOT modifier = opinion_my_owner }
										reverse_opinion = { who = ROOT modifier = opinion_my_slave }
										opinion = { who = ROOT modifier = opinion_enslaved_me }
										random_list = {
											40 = { add_trait = poor_warrior }
											50 = { add_trait = trained_warrior }
											10 = { add_trait = skilled_warrior }
										}
									}
								}
							}
							50 = {
								create_random_soldier = {
									female = yes
									random_traits = yes
									culture = PREVPREV
									religion = PREVPREV
									dynasty = none
								}
								hidden_tooltip = {
									new_character = {
										add_trait = slave
										give_minor_title = title_slave
										opinion = { who = ROOT modifier = opinion_my_owner }
										reverse_opinion = { who = ROOT modifier = opinion_my_slave }
										opinion = { who = ROOT modifier = opinion_enslaved_me }
										random_list = {
											40 = { add_trait = poor_warrior }
											50 = { add_trait = trained_warrior }
											10 = { add_trait = skilled_warrior }
										}
									}
								}
							}
						}
						random_list = {
							50 = {
								create_random_steward = {
									random_traits = yes
									culture = PREVPREV
									religion = PREVPREV
									dynasty = none
								}
								hidden_tooltip = {
									new_character = {
										add_trait = slave
										give_minor_title = title_slave
										opinion = { who = ROOT modifier = opinion_my_owner }
										reverse_opinion = { who = ROOT modifier = opinion_my_slave }
										opinion = { who = ROOT modifier = opinion_enslaved_me }
									}
								}
							}
							50 = {
								create_random_steward = {
									female = yes
									random_traits = yes
									culture = PREVPREV
									religion = PREVPREV
									dynasty = none
								}
								hidden_tooltip = {
									new_character = {
										add_trait = slave
										give_minor_title = title_slave
										opinion = { who = ROOT modifier = opinion_my_owner }
										reverse_opinion = { who = ROOT modifier = opinion_my_slave }
										opinion = { who = ROOT modifier = opinion_enslaved_me }
									}
								}
							}
						}
						random_list = {
							50 = {
								create_random_intriguer = {
									random_traits = yes
									culture = PREVPREV
									religion = PREVPREV
									dynasty = none
								}
								hidden_tooltip = {
									new_character = {
										add_trait = slave
										give_minor_title = title_slave
										opinion = { who = ROOT modifier = opinion_my_owner }
										reverse_opinion = { who = ROOT modifier = opinion_my_slave }
										opinion = { who = ROOT modifier = opinion_enslaved_me }
									}
								}
							}
							50 = {
								create_random_intriguer = {
									female = yes
									random_traits = yes
									culture = PREVPREV
									religion = PREVPREV
									dynasty = none
								}
								hidden_tooltip = {
									new_character = {
										add_trait = slave
										give_minor_title = title_slave
										opinion = { who = ROOT modifier = opinion_my_owner }
										reverse_opinion = { who = ROOT modifier = opinion_my_slave }
										opinion = { who = ROOT modifier = opinion_enslaved_me }
									}
								}
							}
						}
						random_list = {
							50 = {
								create_random_priest = {
									random_traits = yes
									culture = PREVPREV
									religion = PREVPREV
									dynasty = none
								}
								hidden_tooltip = {
									new_character = {
										add_trait = slave
										give_minor_title = title_slave
										opinion = { who = ROOT modifier = opinion_my_owner }
										reverse_opinion = { who = ROOT modifier = opinion_my_slave }
										opinion = { who = ROOT modifier = opinion_enslaved_me }
									}
								}
							}
							50 = {
								create_random_priest = {
									female = yes
									random_traits = yes
									culture = PREVPREV
									religion = PREVPREV
									dynasty = none
								}
								hidden_tooltip = {
									new_character = {
										add_trait = slave
										give_minor_title = title_slave
										opinion = { who = ROOT modifier = opinion_my_owner }
										reverse_opinion = { who = ROOT modifier = opinion_my_slave }
										opinion = { who = ROOT modifier = opinion_enslaved_me }
									}
								}
							}
						}
					}
				}	
			}	
		}
			
		# Auto-enslave all prisoners of war
		FROM = {
			any_realm_character = {
				limit = {
					prisoner = yes
					host = { character = ROOT }
					is_liege_or_above = FROM
					NOT = { trait = slave }
				}
				add_trait = slave
				hidden_tooltip = {
					prisoner = no
					clr_character_flag = captured_in_battle
					clr_character_flag = lost_trial_by_combat
					clr_character_flag = imprisoned_for_relatives_crimes
					ROOT = { reverse_banish = PREV }
					give_minor_title = title_slave
					opinion = { who = ROOT modifier = opinion_my_owner }
					reverse_opinion = { who = ROOT modifier = opinion_my_slave }
					opinion = { who = ROOT modifier = opinion_enslaved_me }
				}
			}
		}
	}
	
	on_fail = {
		# Auto-enslave all prisoners of war
		FROM = {
			any_realm_character = {
				limit = {
					prisoner = yes
					host = { character = ROOT }
					is_liege_or_above = FROM
					NOT = { trait = slave }
				}
				add_trait = slave
				hidden_tooltip = {
					prisoner = no
					clr_character_flag = captured_in_battle
					clr_character_flag = lost_trial_by_combat
					clr_character_flag = imprisoned_for_relatives_crimes
					ROOT = { reverse_banish = PREV }
					give_minor_title = title_slave
					opinion = { who = ROOT modifier = opinion_my_owner }
					reverse_opinion = { who = ROOT modifier = opinion_my_slave }
					opinion = { who = ROOT modifier = opinion_enslaved_me }
				}
			}
		}
		ROOT = { prestige = -100 }
	}
	
	on_reverse_demand = {
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		# Free all prisoners
		FROM = {
			any_realm_character = {
				limit = {
					is_liege_or_above = FROM
					prisoner = yes
					host = { character = ROOT }
				}
				prisoner = no
				clr_character_flag = captured_in_battle
				clr_character_flag = lost_trial_by_combat
				clr_character_flag = imprisoned_for_relatives_crimes
			}
		}
		ROOT = { 
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 3.0
			}
		}
	}
	
	on_reverse_demand_title = {
		location = {
			ROOT = {
				# Free and repatriate all slaves that are:
				#	- of the target province's culture
				#	- of the defender's culture
				#	- of the defender's dynasty
				#	- of the defender's spouse's dynasty
				any_courtier = {
					limit = {
						trait = slave
						has_opinion_modifier = { who = ROOT modifier = opinion_my_owner }
						OR = {
							culture = PREVPREV
							culture = FROM
							dynasty = FROM
							FROM = { spouse = { dynasty = PREVPREV } }
							is_close_relative = FROM
							FROM = { spouse = { is_close_relative = PREVPREV } }
						}
					}
					character_event = { id = slavery.0 tooltip = "EVTTOOLTIPSLAVERY0" }
					hidden_tooltip = { FROM = { reverse_banish = PREV } }
				}
			}
		}
	}
	
	attacker_ai_victory_worth = {
		factor = -1 # Always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # Always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	
}
slave_revolt = {
	name = CB_NAME_SLAVE_REVOLT
	war_name = WAR_NAME_SLAVE_REVOLT
	sprite = 16
	truce_days = 365
	hostile_against_others = yes
	is_permanent = yes
	# check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	check_de_jure_tier = KING # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	press_claim = yes
	can_ask_to_join_war = no
	is_independence = yes
	
	can_use = {
		ROOT = { has_character_flag = slave_rebel }
	}

	can_use_title = {
		tier = king
		OR = {
			has_holder = no
			holder_scope = { 
				OR = {
					same_realm = FROM
					character = FROM
				}	
			}
		}
	}

	is_valid_title = {
		OR = {
			has_holder = no
			holder_scope = { 
				OR = {
					same_realm = FROM
					character = FROM
				}	
			}
		}
	}
	
	on_success = {
		hidden_tooltip = { ROOT = { add_character_modifier = { name = victory_timer duration = 3 } } }
		ROOT = {
			prestige = 1000
			hidden_tooltip = {
				#occupy_minors_of_occupied_settlements = FROM
				gain_all_occupied_titles = FROM
			}	
			clr_character_flag = slave_rebel
			give_nickname = nick_the_liberator
			set_dynasty_flag = liberator_dynasty #give dynasty flag stopping them re-legalising slavery ASAP
		}
		FROM = {
			prestige = -500
		}
	}

	on_success_title = {
		custom_tooltip = {
			text = tribal_invasion_succ_tip
			hidden_tooltip = {
				ROOT = {
					usurp_title = PREV
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
					}				
				}
			}
		}
		add_law = slavery_0
		hidden_tooltip = {
			add_law = treaty_breach_1
			ROOT = {
				any_realm_province = {
					limit = { has_province_modifier = slave_revolt_modifier }
					remove_province_modifier = slave_revolt_modifier
				}
			}
		}
#		if = {
#			limit = { ROOT = { is_landed = no } }
#			FROM = {
#				random_realm_province = {
#					limit = {
#						culture = ROOT
#						kingdom = {
#							title = PREVPREVPREV
#						}
#					}
#					county = {
#						usurp_title = ROOT
#					}
#				}
#			}
#		}
#		grant_title = ROOT

	}

	on_fail_title = {
		FROM = {
			# Random chance of regaining slave camp level
			if = {
				limit = { crownlaw_title = { has_law = slavery_2 } } 
				random = {
					chance = 40
					custom_tooltip = {
						text = TOOLTIPSLAVEREVOLTX
						hidden_tooltip = {
							if = {
								limit = { capital_scope = { has_province_flag = slave_revolt } }
								character_event = { id = slavery.1000 }
								if = {
									limit = { is_merchant_republic = yes }
									any_vassal = { 
										limit = { is_patrician = yes }
										character_event = { id = slavery.1000 }
									}
								}	
							}
							any_realm_lord = {
								limit = { capital_scope = { has_province_flag = slave_revolt } }
								character_event = { id = slavery.1000 }
							}
						}
					}	
				}	
			}
			prestige = 100
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor 
					who = ROOT
					months = 1200
				}
			}
		}
		ROOT = {
			imprison = FROM
			clr_character_flag = slave_rebel
			hidden_tooltip = {
				add_character_modifier = { 
					name = broken_spirit
					days = -1
				}
				remove_trait = inspiring_leader
			}
		}
		hidden_tooltip = {
			FROM = {
				any_realm_province = {
					limit = { has_province_modifier = slave_revolt_modifier }
					remove_province_modifier = slave_revolt_modifier
					clr_province_flag = slave_revolt 
				}
			}
		}
	}

	on_reverse_demand = {
		hidden_tooltip = { FROM = { add_character_modifier = { name = victory_timer duration = 3 } } }
		FROM = {
			# Random chance of regaining slave camp level
			if = {
				limit = { crownlaw_title = { has_law = slavery_2 } } 
				random = {
					chance = 80
					custom_tooltip = {
						text = TOOLTIPSLAVEREVOLTX
						hidden_tooltip = {
							if = {
								limit = { capital_scope = { has_province_flag = slave_revolt } }
								character_event = { id = slavery.1000 }
								if = {
									limit = { is_merchant_republic = yes }
									any_vassal = { 
										limit = { is_patrician = yes }
										character_event = { id = slavery.1000 }
									}
								}	
							}
							any_realm_lord = {
								limit = { capital_scope = { has_province_flag = slave_revolt } }
								character_event = { id = slavery.1000 }
							}
						}
					}	
				}	
			}
			prestige = 200
			hidden_tooltip = {
				opinion = {
					modifier = opinion_rebel_traitor 
					who = ROOT
					months = 1200
				}
			}
		}
		ROOT = {
			imprison = FROM
			clr_character_flag = slave_rebel
			hidden_tooltip = {
				add_character_modifier = { 
					name = broken_spirit
					days = -1
				}
				remove_trait = inspiring_leader
			}
		}
		hidden_tooltip = {
			FROM = {
				any_realm_province = {
					limit = { has_province_modifier = slave_revolt_modifier }
					remove_province_modifier = slave_revolt_modifier
					clr_province_flag = slave_revolt 
				}
				any_realm_province = {
					limit = {
						OR = {
							has_province_modifier = slave_modifier_1
							has_province_modifier = slave_modifier_2
							has_province_modifier = slave_modifier_3
							has_province_modifier = slave_modifier_4
							has_province_modifier = slave_modifier_5
						}
					}
					add_province_modifier = {
						name = crushed_slave_revolt_1
						duration = 3650
					}
				}
			}
		}
	}

	attacker_ai_victory_worth = {
		factor = 100
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}
war_of_liberation = {
	name = CB_NAME_LIBERATION
	war_name = WAR_NAME_LIBERATION
	sprite = 28
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	can_ask_to_join_war = no
	
	can_use_gui = {
		ROOT = {
			NOT = { trait = incapable }
			OR = { #Must either be liberator, or target broke anti-slavery treaty
				trait = liberator
				FROM = { primary_title = { has_law = treaty_breach_0 } }
			}
			OR = { #Must either...
				culture_group = FROM #be same culture
				custom_tooltip = { #Neighbour target
					text = TOOLTIPwar_of_liberationNEIGHBOUR
					hidden_tooltip = {
						any_realm_province = { 
							any_neighbor_province = {
								owner = {
									OR = {
										character = FROM
										same_realm = FROM
									}
								}
							}
						}
					}
				}	
			}
		}	
	}
	
	can_use_title = {
		ROOT = {
			primary_title = { has_law = slavery_0 }
		}
		FROM = {
			has_landed_title = PREV
		}
		OR = { #Must either be liberator, or target broke anti-slavery treaty
			ROOT = { trait = liberator }
			FROM = { primary_title = { has_law = treaty_breach_0 } }
		}
		is_primary_holder_title = yes
		higher_tier_than = DUKE
		has_law = slavery_2		
	}
	
	is_valid_title = {
		ROOT = {
			primary_title = { has_law = slavery_0 }
		}
		FROM = {
			has_landed_title = PREV
		}	
	}
	
	on_add = { 
		hidden_tooltip = {
			ROOT = {
				character_event = { id = lirepublic.100 days = 1 } #Co-consuls can veto
			}
		}
	}
	
	on_success = {
		hidden_tooltip = { ROOT = { add_character_modifier = { name = victory_timer duration = 3 } } } 
		ROOT = {
			prestige = 200
		}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 200
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		
		hidden_tooltip = {
			ROOT = {
				occupy_minors_of_occupied_settlements = FROM
				gain_all_occupied_titles = FROM			
			}
		}
		
		FROM = {
			prestige = -400
		}	
	}
	
	on_success_title = {	
	
		custom_tooltip = {
			text = invasion_succ_tip
			hidden_tooltip = {
				usurp_title_plus_barony_if_unlanded = ROOT
				FROM = { 					
					any_demesne_title = {
						limit = { tier = PREVPREV }
						usurp_title = ROOT
						ROOT = { set_character_flag = flag_slavery_treaty_breach }
						add_law = slavery_0
						add_law = treaty_breach_1
					}
					set_defacto_liege = ROOT 
				}
				if = {
					limit = {
						FROM = { is_liege_or_above = ROOT }
					}
					FROM = { imprison = ROOT }
				}
			}
		}
		ROOT = { set_character_flag = flag_slavery_treaty_breach }
		add_law = slavery_0
		hidden_tooltip = {
			add_law = treaty_breach_1
			FROM = {
				any_demesne_title = { 
					limit = { 
						higher_tier_than = DUKE
						NOT = { has_law = slavery_0 } 
					} 
					add_law = slavery_0 
				}
				any_vassal = { 
					any_demesne_title = { 
						limit = { 
							higher_tier_than = DUKE
							NOT = { has_law = slavery_0 } 
						} 
						add_law = slavery_0 
					} 
				}
			}		
		}	
	}
	
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }	
		}	
	}

	on_reverse_demand = {
		hidden_tooltip = { FROM = { add_character_modifier = { name = victory_timer duration = 3 } } }
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 200
			any_demesne_title = {
				limit = { has_law = treaty_breach_0 }
				revoke_law = treaty_breach_0
			}
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		hidden_tooltip = {
			FROM = {
				any_realm_province = {
					limit = {
						OR = {
							has_province_modifier = slave_modifier_1
							has_province_modifier = slave_modifier_2
							has_province_modifier = slave_modifier_3
							has_province_modifier = slave_modifier_4
							has_province_modifier = slave_modifier_5
						}
					}
					add_province_modifier = {
						name = thwarted_war_of_liberation_1
						duration = 3650
					}
				}
			}
		}
	}

	attacker_ai_victory_worth = {
		factor = 150
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
	
}
war_of_emancipation = {
	name = CB_NAME_EMANCIPATION
	war_name = WAR_NAME_EMANCIPATION
	sprite = 28
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	can_ask_to_join_war = no
	
	can_use_gui = {
		ROOT = {
			OR = { #Must either...
				trait = liberator
				culture_group = FROM #be same culture	
				custom_tooltip = { #Neighbour target
					text = TOOLTIPwar_of_liberationNEIGHBOUR
					hidden_tooltip = {
						any_realm_province = { 
							any_neighbor_province = {
								owner = {
									OR = {
										character = FROM
										same_realm = FROM
									}
								}
							}
						}
					}
				}	
			}
		}	
	}
	
	can_use_title = {
		ROOT = {
			primary_title = { has_law = slavery_0 }
		}
		FROM = {
			has_landed_title = PREV	
		}	
		is_primary_holder_title = yes
		higher_tier_than = DUKE
		has_law = slavery_2		
	}
	
	is_valid_title = {
		ROOT = {
			primary_title = { has_law = slavery_0 }
		}
		FROM = {
			has_landed_title = PREV	
		}		
	}
	
	on_add = { 
		hidden_tooltip = {
			ROOT = {
				character_event = { id = lirepublic.100 days = 1 } #Co-consuls can veto
			}
		}
	}
	
	on_success_title = {
		hidden_tooltip = { ROOT = { add_character_modifier = { name = victory_timer duration = 3 } } } 
		add_law = slavery_1
		hidden_tooltip = {
			FROM = {
				add_character_modifier = { 
					name = realm_emancipated
					duration = 3650 
				}
				any_demesne_title = { 
					limit = { 
						higher_tier_than = DUKE
						NOT = { has_law = slavery_0 } 
					} 
					add_law = slavery_1 
				}
				any_vassal = { 
					any_demesne_title = { 
						limit = { 
							higher_tier_than = DUKE
							NOT = { has_law = slavery_0 } 
						} 
						add_law = slavery_1 
					} 
				}
			}
		}	
	}
	
	on_success = {
		#Also emancipate any defenders
		any_defender = {
			limit = { NOT = { character = FROM } }
			any_demesne_title = { 
				limit = { 
					higher_tier_than = DUKE
					NOT = { has_law = slavery_0 } 
				} 
				add_law = slavery_1 
				holder_scope = {
					hidden_tooltip = {
						add_character_modifier = { 
							name = realm_emancipated
							duration = 3650 
						}
					}
				}
			}
		}
		ROOT = { 
			prestige = 250
		}
		hidden_tooltip = {
			any_attacker = {
				limit = { NOT = { character = ROOT } }
				participation_scaled_prestige = 250
			}
		}
		FROM = { prestige = -250 }	
	}
	
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }	
		}	
	}

	on_reverse_demand = {
		hidden_tooltip = { FROM = { add_character_modifier = { name = victory_timer duration = 3 } } }
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		hidden_tooltip = {
			FROM = {
				any_realm_province = {
					limit = {
						OR = {
							has_province_modifier = slave_modifier_1
							has_province_modifier = slave_modifier_2
							has_province_modifier = slave_modifier_3
							has_province_modifier = slave_modifier_4
							has_province_modifier = slave_modifier_5
						}
					}
					add_province_modifier = {
						name = thwarted_war_of_emancipation_1
						duration = 3650
					}
				}
			}
		}
	}

	attacker_ai_victory_worth = {
		factor = -1
	}
	
	attacker_ai_defeat_worth = {
		factor = 150
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
	
	ai_will_do = {
		factor = 0.5
	}
}
war_of_enslavement = {
	name = CB_NAME_ENSLAVEMENT
	war_name = WAR_NAME_ENSLAVEMENT
	sprite = 28
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	can_ask_to_join_war = no
	
	can_use_gui = {
		ROOT = {
			NOT = { trait = incapable }
#			OR = { #Must either...
				custom_tooltip = { #Neighbour target
					text = TOOLTIPwar_of_liberationNEIGHBOUR
					hidden_tooltip = {
						any_realm_province = { 
							any_neighbor_province = {
								owner = {
									OR = {
										character = FROM
										same_realm = FROM
									}
								}
							}
						}
					}
				}	
#			}
		}	
	}
	
	can_use_title = {
		ROOT = {
			primary_title = { has_law = slavery_2 }
		}
		FROM = {
			has_landed_title = PREV
		}
		higher_tier_than = DUKE
		has_law = treaty_breach_1
		has_law = slavery_0
		is_primary_holder_title = yes
#		OR = {
			tier = EMPEROR
#		}	
	}
	
	is_valid_title = {
		ROOT = {
			primary_title = { has_law = slavery_2 }
		}
		FROM = {
			has_landed_title = PREV
		}	
	}
	
	on_add = { 
		hidden_tooltip = {
			ROOT = {
				character_event = { id = lirepublic.100 days = 1 } #Co-consuls can veto
			}
		}
	}
	
	on_success = {
		hidden_tooltip = { ROOT = { add_character_modifier = { name = victory_timer duration = 3 } } } 
		ROOT = {
			prestige = 200
		}
		any_attacker = {
			limit = { character = ROOT }
			participation_scaled_prestige = 200
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		FROM = {
			capital_scope = {
				# The attacker gains a slave camp level
				if = {
					limit = { ROOT = { crownlaw_title = { has_law = slavery_2 } } }
					ROOT = { character_event = { id = slavery.1000 tooltip = "EVTTOOLTIPSLAVERY1000" } }
				}
				custom_tooltip = { # Give the attacker new slaves
					text = TOOLTIPslave_raid_new_slaves
					hidden_tooltip = {
						ROOT = {
							random_list = {
								50 = {
									create_random_diplomat = {
										random_traits = yes
										culture = PREVPREV
										religion = PREVPREV
										dynasty = none
									}
									hidden_tooltip = {
										new_character = {
											add_trait = slave
											give_minor_title = title_slave
											opinion = { who = ROOT modifier = opinion_my_owner }
											reverse_opinion = { who = ROOT modifier = opinion_my_slave }
											opinion = { who = ROOT modifier = opinion_enslaved_me }
										}
									}
								}
								50 = {
									create_random_diplomat = {
										female = yes
										random_traits = yes
										culture = PREVPREV
										religion = PREVPREV
										dynasty = none
									}
									hidden_tooltip = {
										new_character = {
											add_trait = slave
											give_minor_title = title_slave
											opinion = { who = ROOT modifier = opinion_my_owner }
											reverse_opinion = { who = ROOT modifier = opinion_my_slave }
											opinion = { who = ROOT modifier = opinion_enslaved_me }
										}
									}
								}
							}
							random_list = {
								50 = {
									create_random_soldier = {
										random_traits = yes
										culture = PREVPREV
										religion = PREVPREV
										dynasty = none
									}
									hidden_tooltip = {
										new_character = {
											add_trait = slave
											give_minor_title = title_slave
											opinion = { who = ROOT modifier = opinion_my_owner }
											reverse_opinion = { who = ROOT modifier = opinion_my_slave }
											opinion = { who = ROOT modifier = opinion_enslaved_me }
											random_list = {
												40 = { add_trait = poor_warrior }
												50 = { add_trait = trained_warrior }
												10 = { add_trait = skilled_warrior }
											}
										}
									}
								}
								50 = {
									create_random_soldier = {
										female = yes
										random_traits = yes
										culture = PREVPREV
										religion = PREVPREV
										dynasty = none
									}
									hidden_tooltip = {
										new_character = {
											add_trait = slave
											give_minor_title = title_slave
											opinion = { who = ROOT modifier = opinion_my_owner }
											reverse_opinion = { who = ROOT modifier = opinion_my_slave }
											opinion = { who = ROOT modifier = opinion_enslaved_me }
											random_list = {
												40 = { add_trait = poor_warrior }
												50 = { add_trait = trained_warrior }
												10 = { add_trait = skilled_warrior }
											}
										}
									}
								}
							}
							random_list = {
								50 = {
									create_random_steward = {
										random_traits = yes
										culture = PREVPREV
										religion = PREVPREV
										dynasty = none
									}
									hidden_tooltip = {
										new_character = {
											add_trait = slave
											give_minor_title = title_slave
											opinion = { who = ROOT modifier = opinion_my_owner }
											reverse_opinion = { who = ROOT modifier = opinion_my_slave }
											opinion = { who = ROOT modifier = opinion_enslaved_me }
										}
									}
								}
								50 = {
									create_random_steward = {
										female = yes
										random_traits = yes
										culture = PREVPREV
										religion = PREVPREV
										dynasty = none
									}
									hidden_tooltip = {
										new_character = {
											add_trait = slave
											give_minor_title = title_slave
											opinion = { who = ROOT modifier = opinion_my_owner }
											reverse_opinion = { who = ROOT modifier = opinion_my_slave }
											opinion = { who = ROOT modifier = opinion_enslaved_me }
										}
									}
								}
							}
							random_list = {
								50 = {
									create_random_intriguer = {
										random_traits = yes
										culture = PREVPREV
										religion = PREVPREV
										dynasty = none
									}
									hidden_tooltip = {
										new_character = {
											add_trait = slave
											give_minor_title = title_slave
											opinion = { who = ROOT modifier = opinion_my_owner }
											reverse_opinion = { who = ROOT modifier = opinion_my_slave }
											opinion = { who = ROOT modifier = opinion_enslaved_me }
										}
									}
								}
								50 = {
									create_random_intriguer = {
										female = yes
										random_traits = yes
										culture = PREVPREV
										religion = PREVPREV
										dynasty = none
									}
									hidden_tooltip = {
										new_character = {
											add_trait = slave
											give_minor_title = title_slave
											opinion = { who = ROOT modifier = opinion_my_owner }
											reverse_opinion = { who = ROOT modifier = opinion_my_slave }
											opinion = { who = ROOT modifier = opinion_enslaved_me }
										}
									}
								}
							}
							random_list = {
								50 = {
									create_random_priest = {
										random_traits = yes
										culture = PREVPREV
										religion = PREVPREV
										dynasty = none
									}
									hidden_tooltip = {
										new_character = {
											add_trait = slave
											give_minor_title = title_slave
											opinion = { who = ROOT modifier = opinion_my_owner }
											reverse_opinion = { who = ROOT modifier = opinion_my_slave }
											opinion = { who = ROOT modifier = opinion_enslaved_me }
										}
									}
								}
								50 = {
									create_random_priest = {
										female = yes
										random_traits = yes
										culture = PREVPREV
										religion = PREVPREV
										dynasty = none
									}
									hidden_tooltip = {
										new_character = {
											add_trait = slave
											give_minor_title = title_slave
											opinion = { who = ROOT modifier = opinion_my_owner }
											reverse_opinion = { who = ROOT modifier = opinion_my_slave }
											opinion = { who = ROOT modifier = opinion_enslaved_me }
										}
									}
								}
							}
						}
					}	
				}	
			}
			
			# Auto-enslave all prisoners of war
			any_realm_character = {
				limit = {
					prisoner = yes
					host = { character = ROOT }
					is_liege_or_above = FROM
					NOT = { trait = slave }
				}
				add_trait = slave
				hidden_tooltip = {
					prisoner = no
					clr_character_flag = captured_in_battle
					clr_character_flag = lost_trial_by_combat
					clr_character_flag = imprisoned_for_relatives_crimes
					ROOT = { reverse_banish = PREV }
					give_minor_title = title_slave
					opinion = { who = ROOT modifier = opinion_my_owner }
					reverse_opinion = { who = ROOT modifier = opinion_my_slave }
					opinion = { who = ROOT modifier = opinion_enslaved_me }
				}
			}
		}
		hidden_tooltip = {
			ROOT = {
				occupy_minors_of_occupied_settlements = FROM
				gain_all_occupied_titles = FROM			
			}
		}
		
		FROM = {
			prestige = -400
		}
	}
	
	on_success_title = {	
		custom_tooltip = {
			text = invasion_succ_tip
			hidden_tooltip = {
				usurp_title_plus_barony_if_unlanded = ROOT
				FROM = { 
					set_defacto_liege = ROOT 
				}
				if = {
					limit = {
						FROM = { is_liege_or_above = ROOT }
					}
					FROM = { imprison = ROOT }
				}
			}
		}
		add_law = slavery_2
	}
	
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }	
		}
	}
	
	on_reverse_demand_title = {
		if = {
			limit = { has_law = treaty_breach_1 }
			revoke_law = treaty_breach_1
		}
	}

	on_reverse_demand = {
		hidden_tooltip = { FROM = { add_character_modifier = { name = victory_timer duration = 3 } } }
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = { character = FROM }
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

	attacker_ai_victory_worth = {
		factor = 150
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
	
	ai_will_do = {
		factor = 1.5
	}
}